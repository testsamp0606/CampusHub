// rules_version = '2';
// 
// service cloud.firestore {
//   match /databases/{database}/documents {
// 
//     // Deny all reads and writes by default
//     match /{document=**} {
//       allow read, write: if false;
//     }
// 
//     // Skips auth check for SuperAdmin
//     function isSuperAdmin() {
//       return request.auth != null && request.auth.token.superAdmin == true;
//     }
// 
//     //
//     // Helper Functions
//     //
// 
//     function isSchoolMember(schoolId) {
//       return isSuperAdmin() || get(/databases/$(database)/documents/schools/$(schoolId)/users/$(request.auth.uid)).data.schoolId == schoolId;
//     }
// 
//     function isSchoolAdmin(schoolId) {
//       return isSuperAdmin() || get(/databases/$(database)/documents/schools/$(schoolId)/users/$(request.auth.uid)).data.role == 'Admin';
//     }
// 
//     //
//     // Rule Implementation
//     //
// 
//     function canReadSchoolData(schoolId) {
//       return isSchoolMember(schoolId);
//     }
// 
//     function canCreateSchoolData(schoolId) {
//       return isSchoolAdmin(schoolId);
//     }
// 
//     function canModifySchoolData(schoolId) {
//       return isSchoolAdmin(schoolId);
//     }
// 
//     //
//     // Path-based Rules
//     //
// 
//     match /schools/{schoolId} {
//       allow read: if canReadSchoolData(schoolId);
//       allow write: if canModifySchoolData(schoolId);
// 
//       // Students
//       match /students/{studentId} {
//         allow read: if canReadSchoolData(schoolId);
//         allow create: if canReadSchoolData(schoolId); // Changed from canCreateSchoolData
//         allow update, delete: if canModifySchoolData(schoolId);
//       }
//       
//        // Events
//       match /events/{eventId} {
//         allow read: if canReadSchoolData(schoolId);
//         allow write: if canCreateSchoolData(schoolId);
//       }
//       
//        // Subjects
//       match /subjects/{subjectId} {
//         allow read: if canReadSchoolData(schoolId);
//         allow write: if canCreateSchoolData(schoolId);
//       }
// 
//       // Catch-all for other subcollections
//       match /{subcollection}/{docId} {
//         allow read: if canReadSchoolData(schoolId);
//         allow write: if canCreateSchoolData(schoolId);
//       }
//     }
//   }
// }